---
sidebar_position: 4
sidebar_label: 'Триггерные сценарии'
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import changeDesign from '/img/ecom/ecom-triggers/change-design.png';
import preview from '/img/ecom/ecom-triggers/preview.png';
import preview1 from '/img/ecom/ecom-triggers/preview1.png';
import delayTime from '/img/ecom/ecom-triggers/delay-time.png';

# Руководство по триггерным сценариям для онлайн-продаж

**Триггерный сценарий для онлайн-продаж** — это автоматическая отправка писем, с помощью которых можно вернуть подписчика на сайт. В таких сценариях рассылки отправляются при наступлении соответствующего события на сайте: когда подписчик посмотрел товар или категорию, добавил товар в корзину и так далее.

С триггерными сценариями для онлайн-продаж можно максимально персонализировать коммуникации, используя данные о поведении подписчиков на сайте. Чтобы настроить такой сценарий, сперва нужно подключить модуль «Sendsay Продажи» и настроить передачу данных сайта в Sendsay.

[Модуль «Sendsay Продажи»: что это и как подключить](https://docs.sendsay.ru/ecom/how-to-connect-ecom)

С версиями модуля «Продажи Старт» и «Продажи» можно запустить несколько таких сценариев:

- Брошенная корзина — пользователь положил товар в корзину и не оформил заказ. Через полчаса ему приходит письмо с товарами корзины;
- Брошенный просмотр — пользователь просмотрел карточки товаров и не оформил заказ. Через полчаса ему приходит письмо с просмотренными товарами;
- Брошенная категория — пользователь посмотрел категорию товаров и не перешёл в карточку ни одного из товаров. Через полчаса ему приходит письмо с товарами из категории.

:::tip Важно

По умолчанию триггерные события наступают через 30 минут после действия пользователя на сайте. Время отправки писем можно изменить в настройках сценария.

:::

## Как подключить сценарий

1. Перейдите в раздел **Продажи** в боковом меню и выберите вкладку **Сценарии** на странице сайта.
2. Выберите нужный сценарий из доступных и кликните по кнопке «Подключить»: ![How to connect workflow](/img/ecom/ecom-triggers/how-to-connect-workflow.png)
3. После подключения сценария перейдите в его настройки, нажав кнопку «Просмотр».

В списке сценариев отображаются статусы — активны они или нет. Также выводятся данные:

![List of workflows](/img/ecom/ecom-triggers/list-of-workflows.png)

- **Всего участий** — сколько раз подписчики попадали в сценарий, в том числе повторно,
- **Завершений** — сколько подписчиков завершили сценарий, в том числе повторно.

Эти показатели учитывают каждого участника, даже если он только попал в сценарий. Или если сценарий был завершён принудительно — например, когда участник совершил событие, завершающее сценарий.

[События, завершающие сценарий](https://docs.sendsay.ru/ecom/how-to-connect-ecom#события-завершающие-сценарий)

## Как настроить сценарий

Перед настройкой сценария рекомендуем подключить каталог товаров — он понадобится для сценария Брошенная категория и товарных рекомендаций в письмах.

[Как подключить каталог товаров](https://docs.sendsay.ru/ecom/product-catalog)

Каждый сценарий настраивается по одному принципу: нужно добавить письмо в сценарий и установить время задержки отправки. Исключением является сценарий Брошенная корзина [на платной версии модуля «Продажи»](https://docs.sendsay.ru/ecom/how-to-connect-ecom#возможности-версий) — в такой сценарий можно добавить до 5 писем.

Чтобы настроить сценарий:

### 1. Добавьте письмо

Перейдите в раздел **Продажи → Сценарии**, выберите из списка нужный сценарий и нажмите «Просмотр». Затем на странице сценария выберите вкладку **Настройка** и на шаге Письмо 1 нажмите «Редактировать»:

![Workflow settings](/img/ecom/ecom-triggers/workflow-settings.png)

Во всплывающем окне откроется редактирование письма. На шаге **Письмо** нажмите «Редактировать» в превью шаблона, затем отредактируйте его контент и оформление.

<Tabs>
  <TabItem value="key1" label="Редактирование шаблона" default>
    Дизайн блока со специальным кодом для вывода товаров уже есть в шаблоне письма — его можно не редактировать:

    ![Template](/img/ecom/ecom-triggers/template.png)

    [Как создать письмо в блочном редакторе](https://docs.sendsay.ru/videolessons/email-campaigns/drag-and-drop-editor)

    Если всё же нужно отредактировать, шаблоны таких блоков доступны в папке **Контент → Название вашего сайта**.

  </TabItem>

  <TabItem value="key2" label="Изменение дизайна">
    Вы можете сменить дизайн письма, нажав на три точки в правом нижнем углу в блочном редакторе:

    <p align="center">
      <img width="50%" src={changeDesign} alt="Change design" />
    </p>

    Если вы сменили дизайн письма, в макет нужно добавить команду подстановки — чтобы сценарий заработал. Для этого перетащите в письмо HTML-блок и задайте отступ 0 справа и слева, затем пропишите в блоке код шаблона:

    - для сценария Брошенный просмотр:<br />
      `[% draft("id","mysite.ru_product_view") %]`

    - для сценария Брошенная корзина:<br />
      `[% draft("id","mysite.ru_basket") %]`

    - для сценария Брошенная категория:<br />
      `[% draft("id","mysite.ru_category_view") %]`

    Где `mysite.ru` — название подключенного сайта. Например, так будет выглядеть код для сайта Sendsay:

    ```
    [% draft("id","sendsay.ru_category_view") %]
    ```

    ![How to insert the code](/img/ecom/ecom-triggers/change-design1.gif)

    [Как создать письмо в блочном редакторе](https://docs.sendsay.ru/videolessons/email-campaigns/drag-and-drop-editor)

  </TabItem>

  <TabItem value="key3" label="Свой шаблон в HTML">
    Если вы используете свой шаблон в HTML, в нём нужно сверстать блок с выводом товаров. Как это сделать — читайте в статье по ссылке ниже.<br /><br />

    [Шаблонизатор PROScript](https://docs.sendsay.ru/ecom/ecom-proscript)

  </TabItem>
</Tabs>

Когда контент письма готов, сохраните его и вернитесь к редактированию письма. На шаге **Письмо** задайте рассылке нужные настройки: **Имя отправителя**, **Email отправителя** и **Тему письма**.

### 2. Посмотрите письмо, подставив данные подписчика

Этот пункт необязательный, но он поможет понять, что в письме всё работает так, как вы ожидаете. Для этого:

1. Перейдите на страницу нужного сценария и откройте вкладку **Настройка**.

2. Выберите письмо и нажмите «Просмотреть»:

   ![How to view an email with subscriber data](/img/ecom/ecom-triggers/how-to-view-email.png)

3. В правом верхнем углу кликните по ссылке «Без персонализации» и выберите пункт **Выбрать подписчика**.

4. В новом окне введите email-адрес подписчика и нажмите «Выбрать подписчика»:

   ![How to view an email with subscriber data](/img/ecom/ecom-triggers/how-to-view-email1.gif)

   Адрес подписчика можно взять из раздела **Продажи → Просмотр событий**. Для этого отфильтруйте таблицу по нужному событию.

Посмотреть письмо с данными подписчика можно также в редакторе письма:

1. Выберите нужный шаблон письма в разделе **Контент** и перейдите к его редактированию.
2. В самом верху экрана кликните по иконке предпросмотра:

   <p align="center">
     <img width="50%" src={preview} alt="Preview" />
   </p>

3. Справа появится меню предпросмотра — выберите пункт **Посмотреть письмо с данными конкретного подписчика**, введите email и нажмите кнопку «Применить».

   <p align="center">
     <img width="50%" src={preview1} alt="Preview" />
   </p>

После этого вернитесь на страницу сценария.

### 3. Настройте время задержки отправки

На шаге **Время задержки** нажмите «Изменить» и установите нужное время:

<p align="center">
  <img width="50%" src={delayTime} alt="Delay time" />
</p>

:::tip Важно

Отправка первого письма в сценарии запускается автоматически через 30 минут после наступления события — это время можно увеличить вручную. Если вы хотите уменьшить или увеличить время задержки для всех сценариев вашего аккаунта, обратитесь в техподдержку.

:::

### 4. Добавьте другие письма (опционально)

Вы можете добавить до 5 писем в сценарий Брошенная корзина, если используете платную версию модуля «Продажи». Чтобы создать цепочку из нескольких писем, нажмите «Добавить письмо» при настройке сценария:

![How to add a second email](/img/ecom/ecom-triggers/how-to-add-second-email.png)

При добавлении новых писем в цепочку повторите пункты 1–3.

## Как удалить письмо из сценария

Первое письмо сценария нельзя удалить. Вы можете его отредактировать или заменить шаблон. Если необходимо удалить другие письма из сценария:

1. Перейдите во вкладку **Настройка** на странице сценария и выберите нужное письмо.
2. Откройте раскрывающийся список у кнопки «Редактировать» и выберите пункт **Удалить шаг**:

   ![How to delete email](/img/ecom/ecom-triggers/how-to-delete-email.png)

## Как активировать сценарий

Когда все письма триггерной цепочки добавлены в сценарий, а время задержки установлено, нажмите зелёную кнопку «Активировать» в правом верхнем углу на странице сценария, чтобы запустить его в работу:

![Activate the workflow](/img/ecom/ecom-triggers/activate-the-workflow.png)

После активации кнопка «На паузу» приостановит выпуск рассылок по сценарию.

![Pause the workflow](/img/ecom/ecom-triggers/pause-the-workflow.png)

## Как узнать статистику по сценарию

После запуска триггерного сценария система собирает статистику по основным показателям самого сценария. Чтобы посмотреть показатели, перейдите на страницу сценария: во вкладке **Сводка** собрана статистика по сценарию и всем выпускам в одной таблице.

В статистике по сценарию выводятся данные:

![Statistics](/img/ecom/ecom-triggers/statistics.png)

- **Проходят сценарий** — количество подписчиков, которые попали в сценарий и стоят в очереди на получение хотя бы одного письма из цепочки в текущий момент.
- **Завершений сценария** — число подписчиков, которые получили все письма сценария, а также тех, кто завершил его досрочно: например, если подписчик сделал заказ или для него вручную завершили сценарий.
- **Сделано заказов** — количество совершенных заказов подписчиками, перешедшими на сайт из рассылок сценария.
- **Сумма** — сумма всех покупок, которые оплатили подписчики, перешедшие на сайт из рассылок сценария.

Ниже отображается таблица со статистикой по отправленным выпускам, которые участвовали в этом сценарии — её можно экспортировать в формате .xlsx или .csv. Здесь также можно отфильтровать таблицу по периоду и конкретному выпуску:

![Filter and export](/img/ecom/ecom-triggers/filter-and-export.png)

## Как посмотреть историю событий для конкретного подписчика

В разделе **Продажи → Просмотр событий** выводится информация о событиях — как тот или иной пользователь «гулял» по страницам сайта: просматривал категории и товары, добавлял товары в корзину или оформлял заказ:

![Event viewing](/img/ecom/ecom-triggers/event-viewing.png)

Здесь собраны данные о контактах и их действиях на сайте. Кликните на строку таблицы, чтобы открыть карточку подписчика. Во вкладке **Продажи → Действия на сайте** вы увидите все события, которые совершил подписчик на сайте:

![Subscriber events](/img/ecom/ecom-triggers/subscriber-events.png)

При наведении курсора на конкретное событие появляется кнопка «Детали». Нажмите на неё, если хотите получить более подробную информацию о событии: какой товар посмотрел подписчик или что именно он положил в корзину.

![Event details](/img/ecom/ecom-triggers/event-details.gif)

Если подписчик положил товары в корзину, посмотреть их можно во вкладке **Продажи → Корзина**:

![Shopping cart](/img/ecom/ecom-triggers/shopping-cart.png)

:::tip Важно

Увидеть название, ссылки и картинки товаров, а также общую сумму корзины во вкладке **Корзина** можно только в том случае, если настроена передача этих данных в Sendsay.

:::

Если же подписчик оформлял заказы, информация о них будет храниться во вкладке **Заказы**. При клике на конкретный заказ можно увидеть его детали:

![Orders](/img/ecom/ecom-triggers/orders.png)

[Как посмотреть историю событий сайта](https://docs.sendsay.ru/ecom/how-to-connect-ecom/#как-посмотреть-историю-событий-сайта)

## Как узнать статус участника в сценарии

На странице триггерного сценария собраны данные о контактах — тех, кто проходит или уже завершил сценарий. Эти данные могут пригодиться, например, если вам нужно перенести подписчиков с одинаковым статусом в отдельный список.

Чтобы узнать статус подписчика в сценарии, выберите нужный сценарий и нажмите «Просмотр». Затем на странице сценария откройте вкладку **Просмотр подписчиков**. Здесь находится таблица с тремя колонками: адресами контактов, статусом прохождения сценария и датой — когда тот или иной подписчик совершил последнее действие на сайте:

![Subscriber statuses](/img/ecom/ecom-triggers/subscriber-statuses.png)

Есть несколько статусов прохождения сценария:

- **Проходит сценарий** — когда подписчик попал в сценарий и стоит в очереди на получение хотя бы одного письма цепочки;
- **На паузе** — когда работа сценария приостановлена для конкретного подписчика;
- **Исключен принудительно** — когда наступило событие, завершившее сценарий, либо сценарий для подписчика завершили вручную. Система подскажет точную причину при наведении на иконку `i`.
- **Завершено** — когда подписчик получил все письма сценария.

По этому же принципу можно настроить фильтр в таблице:

![Filter statuses](/img/ecom/ecom-triggers/filter-statuses.png)

Ещё здесь можно завершить сценарий для конкретного подписчика, добавить его в список или вовсе удалить из базы.

### Как вручную завершить сценарий для конкретного подписчика

Чтобы завершить сценарий для конкретных подписчиков, выберите нужные контакты и отметьте их галочкой слева от адреса. Затем нажмите «Завершить сценарий»:

![Forced termination](/img/ecom/ecom-triggers/forced-termination.png)

### Как добавить подписчика в список

Если хотите добавить конкретных подписчиков в список, выберите нужные контакты и отметьте их галочкой слева от адреса. После этого откройте список у кнопки «Завершить сценарий» и выберите пункт **Добавить в список**:

![List entry](/img/ecom/ecom-triggers/list-entry.png)

Затем выберите нужный список и нажмите синюю кнопку «Добавить».

[Что такое список контактов](https://docs.sendsay.ru/subscribers/lists-and-segments/what-is-list)

### Как удалить подписчика из базы

Чтобы удалить подписчиков из базы, выберите нужные контакты и отметьте их галочкой слева от адреса. После откройте список у кнопки «Завершить сценарий» и выберите пункт **Удалить из базы**:

![How to delete subscribers](/img/ecom/ecom-triggers/delete-subscribers.png)

**Читайте также:**<br /> [Где следить за статистикой](https://docs.sendsay.ru/statistics/where-to-track-statistics)<br /> [Всё про статистические отчёты](https://docs.sendsay.ru/statistics/all-about-campaign-reports)
