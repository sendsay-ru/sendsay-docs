---
sidebar_position: 2
---

import templateId from "/img/automations/automations-by-time/how-to-automate-confirmation-emails/template-id.png";
import segmentId from "/img/automations/automations-by-time/how-to-automate-confirmation-emails/segment-id.png";

# Как автоматизировать отправку писем подтверждения

Письмо подтверждения — это письмо со специальной ссылкой, которое отправляется только неподтверждённым контактам. Подписчику нужно перейти по этой ссылке, чтобы подтвердить согласие получать от вас письма — после этого он станет доступным для рассылок.

Письма подтверждения автоматически отправляются всем, кто заполнил форму сбора подписчиков Sendsay. Если же вы регулярно импортируете подписчиков в базу без помощи форм, то можно автоматизировать отправку писем подтверждения в три шага:

## 1. Создайте шаблон письма подтверждения (если его нет)

Создать письмо подтверждения можно в разделе **Контент** двумя способами:

1. В галерее шаблонов выберите «Письмо подтверждения» (блок «Базовые шаблоны»).
2. Выберите любой шаблон и вручную добавьте ссылку подтверждения:

   - в блочном редакторе — `[% param.url_confirm %]`
   - в HTML-редакторе — `<a href="[% param.url_confirm %]"> текст ссылки </a>`

   Чтобы в блочном редакторе прикрепить ссылку к фрагменту текста, в протоколе ссылки выберите пункт `<другой>`:

![Confirmation email template](/img/automations/automations-by-time\how-to-automate-confirmation-emails/confirmation-email-template.gif) <br/>

3. Скопируйте ID шаблона — это число в адресной строке браузера:

<p align="center">
    <img src={templateId} alt="Template ID" />
</p>

## 2. Создайте сегмент

Создайте сегмент для неподтверждённых подписчиков, которые не получали ваши письма подтверждения:

1. Зайдите в раздел **Подписчики → Сегменты** и создайте сегмент. В поле «Тип» укажите «Email» для почты.
2. В новом сегменте перейдите во вкладку **Настройка условий**. В редакторе условий нажмите на плюсик и поставьте следующие значения:

   - состоит в группе → «Не подтвердившие регистрацию»,
   - не был получателем выпуска → любой выпуск по шаблону → выберите шаблон письма подтверждения → за всё время.

   Если у вас несколько писем подтверждения, просто скопируйте последнюю строку столько раз, чтобы выбрать все шаблоны.

3. Нажмите «Сохранить».

![Create a segment for confirmation emails](/img/automations/automations-by-time/how-to-automate-confirmation-emails/create-a-segment-for-confirmation-emails.gif) <br/>

4. Скопируйте ID сегмента в адресной строке браузера:

<p align="center">
    <img src={segmentId} alt="Segment ID" />
</p>

## 3. Создайте действие по расписанию

Чтобы создать действие по расписанию, нужно перейти [в предыдущий интерфейс](https://sendsay.ru/account/).

Перейдите в раздел **Система → Действия по расписанию**. В типе (слева от кнопки «Создать») выберите «API-запрос». Затем:

1. Введите название.
2. Настройте расписание, когда вы хотите отправлять письмо.
3. Введите API-запрос:

```
{
  "action": "member.sendconfirm",
  "confirm": 1,
  "group": "ID сегмента",
  "letter": "код шаблона"
}
```

4. Нажмите «Сохранить и активировать».

![Create automation by time](/img/automations/automations-by-time/how-to-automate-confirmation-emails/create-automation-by-time.gif)
