---
sidebar_position: 1
sidebar_label: 'Как подключить'
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import webPush from '/img/other-channels/web-push/how-to-connect-web-push/web-push.png';
import widget from '/img/other-channels/web-push/how-to-connect-web-push/widget.png';
import signupForm from '/img/other-channels/web-push/how-to-connect-web-push/webpush-signup-form.png';
import widgetUnblocks from '/img/other-channels/web-push/how-to-connect-web-push/how-widget-unblocks-notifications.png';

# Как подключить веб-пуши на сайт

Веб-пуши — это короткие всплывающие сообщения от сайта, которые показываются в браузере или на рабочем столе, даже если сам сайт при этом закрыт.

<p align="center">
  <img src={webPush} alt="Web push" />
</p>

На сайте посетителям показывается виджет подписки — всплывающее окно, которое предлагает подписаться на пуш-рассылку. По умолчанию он выглядит вот так:

<p align="center">
  <img src={widget} alt="Signup widget" />
</p>

Когда посетитель страницы нажмёт «Подписаться», откроется форма подписки браузера — в ней нужно будет разрешить уведомления, чтоб получать вашу рассылку:

<p align="center">
  <img src={signupForm} alt="Browser signup form" />
</p>

Именно вторая форма и активирует подписку, но браузеры из-за настроек в основном скрывают или вообще не показывают её. Виджет скрыть нельзя, поэтому с ним ваша база пуш-подписчиков будет расти быстрее.

Кроме того, виджет предлагает подписку даже тем посетителям, которые уже блокировали ваши уведомления — и при согласии поможет заново разблокировать их с помощью вот такого окна (у каждого браузера оно немного отличается):

<p align="center">
  <img src={widgetUnblocks} alt="Browser signup form" />
</p>

## Установка

### Как подключить новый сайт

1. Откройте раздел **Подписчики → Web push** и нажмите на синюю кнопку «Добавить сайт». В появившемся окне введите адрес сайта и нажмите «Добавить».

:::tip Важно
Чтобы сайт мог отправлять веб-пуши, он должен иметь действующий SSL-сертификат безопасности (это значит, что адрес сайта должен начинаться с https, а не http)
:::

2. В открывшейся вкладке скопируйте код и вставьте его на нужные страницы, посетителям которых вы хотите предлагать подписаться на уведомления.

3. Скачайте файл sendsay_push_sw.js и добавьте его в корень сайта. Файл должен стать доступен по ссылке `https://вашсайт/sendsay_push_sw.js`

### Как добавить виджет на сайт

:::tip Важно
Необходимо только в том случае, если вы подключили сайт раньше 24 декабря 2020 года
:::

Чтобы добавить виджет на сайт, нужно обновить код, который был установлен туда при подключении. Порядок действий зависит от того, в каком интерфейсе вы отправляете пуши — в новом или старом.

Обновление кода не затронет ваше общение с клиентами: запланированные выпуски выйдут в срок, и все подписчики останутся в базе.

<Tabs>
<TabItem value="key1" label="В новом интерфейсе" default>

1. В разделе <b> Подписчики → Web Push </b> откройте нужный сайт и перейдите во вкладку
   <b> Настройка и установка </b>.
2. Скопируйте код и вставьте его на те страницы, посетителям
   которых вы предлагаете подписку — вместо кода, который установлен там сейчас.

</TabItem>
<TabItem value="key2" label="В предыдущем интерфейсе">

В этом случае нужно добавить сайт к Sendsay в новом интерфейсе, потому что только там можно
получить новый код:

1. Перейдите в новый интерфейс.
2. Откройте раздел <b> Подписчики → Web push </b> и нажмите на синюю
   кнопку «Добавить сайт». В появившемся окне введите адрес сайта и нажмите «Добавить».
3. В открывшейся
   вкладке скопируйте код и вставьте его на страницу, посетителям которой вы предлагаете подписку — вместо
   кода, который установлен там сейчас.

После установки вы сможете продолжать работать с пуш-рассылками в старом интерфейсе, хотя многие настройки
пушей там недоступны. Если вы хотите продолжить работу уже в новом интерфейсе, отправляйте рассылки
по сегменту «Все веб-пуши» — там объединятся все старые и новые пуш-подписчики.

</TabItem>
</Tabs>

## Дополнительные настройки

### Виджет подписки

Чтобы настроить виджет, в разделе **Подписчики → Web Push** откройте сайт и перейдите во вкладку **Виджет подписки**. У виджета можно редактировать следующие параметры:

- текст и оформление,
- поведение — когда показывать виджет посетителям сайта,
- интервалы между показами — как часто показывать виджет одному посетителю.

### Отображение формы по клику

Помимо виджета форму подписки можно вызывать по нажатию на любой элемент на странице. Для этого нужно добавить атрибут `data-sendsay-webpush-subscribe` в тег нужного элемента.

### Параметры пуш-рассылки

У пуш-рассылки есть три параметра — их можно настроить во вкладке **Настройки и установка** или задать уже при создании рассылки.

### Период доставки

Веб-пуши отправляются подписчикам, когда они подключены к интернету. Период доставки — это интервал, в течение которого сервис ждёт подключения недоступных подписчиков (по умолчанию 12 часов).

При выборе периода доставки обращайте внимание на то, через какое время веб-пуш перестанет быть актуальным. Не ставьте большие значения, если есть привязка ко времени: например, подписчики вряд ли обрадуются, получив уведомление о вебинаре, который уже закончился, или о промокоде, который больше не действует. А если привязки ко времени нет, и вы, например, хотите сообщить о новом материале на вашем сайте, выберите период побольше, чтобы охватить как можно большую аудиторию.

### Продолжительность показа

Здесь всего два варианта:

- пуш будет показываться фиксированное время (от 8 до 20 секунд в зависимости от браузера),
- пуш будет висеть на экране, пока пользователь его не закроет (вариант по умолчанию).

### Иконка

Иконку лучше настроить сразу, чтобы подписчики видели, от кого пришла рассылка (её можно поменять при создании выпуска). Если отправить пуш без иконки, в уведомлениях появится логотип Sendsay.
